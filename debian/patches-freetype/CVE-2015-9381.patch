Origin: https://savannah.nongnu.org/bugs/?45955
Last-Update: 2019-09-03
Reviewed-by: Sylvain Beucler <beuc@debian.org>

commit 7962a15d64c876870ca0ae435ea2467d9be268d9
Author: Werner Lemberg <wl@gnu.org>
Date:   Mon Sep 14 00:38:26 2015 +0200

    [type1] Fix another potential buffer overflow (#45955).
    
    * src/type1/t1parse (T1_Get_Private_Dict): Assure that check for
    `eexec' doesn't exceed `limit'.

Index: freetype-2.5.2/src/type1/t1parse.c
===================================================================
--- freetype-2.5.2.orig/src/type1/t1parse.c
+++ freetype-2.5.2/src/type1/t1parse.c
@@ -334,15 +334,14 @@
       /* first of all, look at the `eexec' keyword */
       FT_Byte*  cur   = parser->base_dict;
       FT_Byte*  limit = cur + parser->base_len;
-      FT_Byte   c;
 
 
     Again:
       for (;;)
       {
-        c = cur[0];
-        if ( c == 'e' && cur + 9 < limit )  /* 9 = 5 letters for `eexec' + */
-                                            /* whitespace + 4 chars        */
+        if ( cur[0] == 'e'   &&
+             cur + 9 < limit )      /* 9 = 5 letters for `eexec' + */
+                                    /* whitespace + 4 chars        */
         {
           if ( cur[1] == 'e' &&
                cur[2] == 'x' &&
@@ -372,8 +371,15 @@
 
       while ( cur < limit )
       {
-        if ( *cur == 'e' && ft_strncmp( (char*)cur, "eexec", 5 ) == 0 )
-          goto Found;
+        if ( cur[0] == 'e'   &&
+             cur + 5 < limit )
+        {
+          if ( cur[1] == 'e' &&
+               cur[2] == 'x' &&
+               cur[3] == 'e' &&
+               cur[4] == 'c' )
+            goto Found;
+        }
 
         T1_Skip_PS_Token( parser );
         if ( parser->root.error )
