From e3058617f384cb6709f3878f753fa17aca9e3a30 Mon Sep 17 00:00:00 2001
From: Werner Lemberg <wl@gnu.org>
Date: Sun, 13 Sep 2015 08:41:43 +0200
Subject: [PATCH] [type1] Fix potential buffer overflow (#45923).

* src/type1/t1parse.c (T1_Get_Private_Dict): Assure `cur' doesn't
point to end of file buffer.
---
 src/type1/t1parse.c | 9 +++++++++
 1 files changed, 9 insertions(+)

Index: freetype-2.4.9/src/type1/t1parse.c
===================================================================
--- freetype-2.4.9.orig/src/type1/t1parse.c
+++ freetype-2.4.9/src/type1/t1parse.c
@@ -387,6 +387,15 @@
 
       cur   = limit;
       limit = parser->base_dict + parser->base_len;
+
+      if ( cur >= limit )
+      {
+        FT_ERROR(( "T1_Get_Private_Dict:"
+                   " premature end in private dictionary\n" ));
+        error = T1_Err_Invalid_File_Format;
+        goto Exit;
+      }
+
       goto Again;
 
       /* now determine where to write the _encrypted_ binary private  */
