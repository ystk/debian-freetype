Description: Guard the `face->size` handle before attempting to read its value
 (CVE-2022-27406).
Author: Werner Lemberg
Origin: https://gitlab.freedesktop.org/freetype/freetype/-/commit/0c2bdb01a2e1d24a3e592377a6d0822856e10df2
Bug: https://gitlab.freedesktop.org/freetype/freetype/-/issues/1140
Bug-Debian: https://bugs.debian.org/1010183
Last-Update: 2022-04-28

Index: freetype-2.5.2/src/base/ftobjs.c
===================================================================
--- freetype-2.5.2.orig/src/base/ftobjs.c	2023-05-27 13:55:52.345691752 +0200
+++ freetype-2.5.2/src/base/ftobjs.c	2023-05-27 13:55:52.341691753 +0200
@@ -2918,6 +2918,9 @@
     if ( !face )
       return FT_THROW( Invalid_Face_Handle );
 
+    if ( !face->size )
+      return FT_THROW( Invalid_Size_Handle );
+
     if ( !req || req->width < 0 || req->height < 0 ||
          req->type >= FT_SIZE_REQUEST_TYPE_MAX )
       return FT_THROW( Invalid_Argument );
