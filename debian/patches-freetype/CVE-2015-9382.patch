Origin: https://savannah.nongnu.org/bugs/?45922
Last-Update: 2019-09-03
Reviewed-by: Sylvain Beucler <beuc@debian.org>

commit db5a4a9ae7b0048f033361744421da8569642f73
Author: Werner Lemberg <wl@gnu.org>
Date:   Sat Sep 12 08:32:55 2015 +0200

    [psaux] Fix potential buffer overflow (#45922).
    
    * src/psaux/psobjs.c (ps_parser_skip_PS_token): If a token is
    enclosed in balanced expressions, ensure that the cursor position
    doesn't get larger than the current limit.

Index: freetype-2.5.2/src/psaux/psobjs.c
===================================================================
--- freetype-2.5.2.orig/src/psaux/psobjs.c
+++ freetype-2.5.2/src/psaux/psobjs.c
@@ -600,6 +600,9 @@
       error = FT_THROW( Invalid_File_Format );
     }
 
+    if ( cur > limit )
+      cur = limit;
+
     parser->error  = error;
     parser->cursor = cur;
   }
